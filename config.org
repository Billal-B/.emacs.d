#+TITLE: Configuration
#+LANGUAGE: en
#+STARTUP: inlineimages
#+PROPERTY: header-args :tangle yes :cache yes :results silent :padline no
#+TODO: TODO(t) | DONE(d) | FIXME (f) | NO (n)

* Core
** Exec-path
#+begin_src emacs-lisp
(use-package exec-path-from-shell)
(use-package dash)
(require 'dash)
#+end_src

*** Env variable to load
#+begin_src emacs-lisp
(setq bb-env-var '("NEXUS_USER" "NEXUS_PW"))
#+end_src

*** Adds environment variable in Emacs
#+begin_src emacs-lisp
(with-eval-after-load 'exec-path-from-shell
  (dolist (var (-union '("SSH_AUTH_SOCK" "SSH_AGENT_PID" "GPG_AGENT_INFO" "LANG" "LC_CTYPE") bb-env-var))
    (add-to-list 'exec-path-from-shell-variables var)))

(when (or (memq window-system '(mac ns x))
	  (unless (memq system-type '(ms-dos windows-nt))
	    (daemonp)))
  (exec-path-from-shell-initialize))
#+end_src

** Editor
#+BEGIN_SRC emacs-lisp
(add-to-list 'load-path (expand-file-name "lisp" user-emacs-directory))
(require 'bb-func)
(setq user-full-name "Billal B"
      user-mail-address "billal.bou@gmail.com")
(setq org-directory "~/org-files/")
(setq display-line-numbers-type nil)
(global-hi-lock-mode t)
(global-hl-line-mode 1)
(electric-pair-mode t)
(tool-bar-mode 0)
(scroll-bar-mode 0)
(menu-bar-mode 0)
(setq mouse-yank-at-point t)
(global-visual-line-mode t) ; enable visual line mode (soft wrap) globally
(show-paren-mode t)
(winner-mode 1)
(global-auto-revert-mode 1)
(delete-selection-mode 1) ; deletes with region (see https://stackoverflow.com/questions/2627289/how-to-replace-a-region-in-emacs-with-yank-buffer-contents)

;; basic packages
(use-package general)
(use-package hydra)
(use-package hercules)
#+END_SRC

** Major mode leader
#+begin_src emacs-lisp
(general-auto-unbind-keys)
(general-create-definer mode-leader
  :states '(normal insert emacs)
  :prefix "ù"
  :non-normal-prefix "M-ù")
#+end_src

** Backup
[[https://stackoverflow.com/questions/151945/how-do-i-control-how-emacs-makes-backup-files][Stackoverflow thread]]
#+begin_src emacs-lisp
(setq recentf-max-saved-items 300)

(setq savefiles-dir (expand-file-name "savefiles" user-emacs-directory))
(setq backup-directory-alist `(("." . ,savefiles-dir)))
(setq make-backup-files t
      delete-old-versions t
      delete-by-moving-to-trash t
      backup-by-copying t
      kept-new-versions 9
      kept-old-versions 6
      version-control t
      auto-save-default t
      auto-save-timeout 20
      auto-save-interval 100)
#+end_src

** Scrolling
#+begin_src emacs-lisp
  (setq mouse-wheel-scroll-amount '(3 ((shift) . 3))) ;; one line at a time
  (setq mouse-wheel-progressive-speed nil) ;; don't accelerate scrolling
  (setq mouse-wheel-follow-mouse 't) ;; scroll window under mouse
  (setq scroll-step 1) ;; keyboard scroll one line at a time
  (setq scroll-margin 3)
#+end_src

** dired
   Directory first ([[https://www.emacswiki.org/emacs/DiredSortDirectoriesFirst][src]])
#+begin_src emacs-lisp
(setq dired-listing-switches "-lXGh --group-directories-first")
#+end_src

** ediff
#+begin_src emacs-lisp
(setq ediff-window-setup-function 'ediff-setup-windows-plain)
#+end_src

** eldoc
#+begin_src emacs-lisp
(global-eldoc-mode -1)
(setq eldoc-echo-area-use-multiline-p nil)
#+end_src

** Smarter ctrl backspace
#+begin_src emacs-lisp
(defun aborn/backward-kill-word ()
  "Customize/Smart backward-kill-word."
  (interactive)
  (let* ((cp (point))
         (backword)
         (end)
         (space-pos)
         (backword-char (if (bobp)
                            ""           ;; cursor in begin of buffer
                          (buffer-substring cp (- cp 1)))))
    (if (equal (length backword-char) (string-width backword-char))
        (progn
          (save-excursion
            (setq backword (buffer-substring (point) (progn (forward-word -1) (point)))))
          (setq ab/debug backword)
          (save-excursion
            (when (and backword          ;; when backword contains space
                       (s-contains? " " backword))
              (setq space-pos (ignore-errors (search-backward " ")))))
          (save-excursion
            (let* ((pos (ignore-errors (search-backward-regexp "\n")))
                   (substr (when pos (buffer-substring pos cp))))
              (when (or (and substr (s-blank? (s-trim substr)))
                        (s-contains? "\n" backword))
                (setq end pos))))
          (if end
              (kill-region cp end)
            (if space-pos
                (kill-region cp space-pos)
              (backward-kill-word 1))))
      (kill-region cp (- cp 1)))         ;; word is non-english word
    ))

(global-set-key  [C-backspace]
		 'aborn/backward-kill-word)
#+end_src

* Evil
** Packages
 #+begin_src emacs-lisp
 (use-package evil)
 (use-package evil-visualstar)
 (use-package evil-mc)
 #+end_src

** Configuration
 #+begin_src emacs-lisp
 (require 'evil)
 (require 'general)
 (require 'evil-mc)
 (evil-mode 1)

 (setq evil-want-fine-undo nil)
 #+end_src
*** TODO use emacs binding in insert mode
 #+begin_src emacs-lisp
 (setq evil-insert-state-map (make-sparse-keymap))
 #+end_src
*** Disable evils in some modes
 #+begin_src emacs-lisp
 (setq evil-default-state 'insert)

 (evil-set-initial-state 'dashboard-mode 'insert)
 (evil-set-initial-state 'edebug-mode 'insert)
 (evil-set-initial-state 'term-mode 'insert)
 (evil-set-initial-state 'magit-mode 'insert)
 (evil-set-initial-state 'dired-mode 'insert)
 (evil-set-initial-state 'docker-image-mode 'insert)
 (evil-set-initial-state 'docker-container-mode 'insert)
 (evil-set-initial-state 'docker-volume-mode 'insert)
 (evil-set-initial-state 'docker-network-mode 'insert)
 (evil-set-initial-state 'help-mode 'insert)
 (evil-set-initial-state 'help-mode 'insert)
 (evil-set-initial-state 'xref--xref-buffer-mode 'insert)
 (evil-set-initial-state 'kubernetes-mode 'insert)
 (evil-set-initial-state 'flycheck-error-list-mode 'insert)
 (evil-set-initial-state 'text-mode 'insert)
 (evil-set-initial-state 'cider-repl-mode 'insert)
 (evil-set-initial-state 'cider-inspector-mode 'insert)
 (evil-set-initial-state 'edebug-mode 'insert)
 (evil-set-initial-state 'treinsert-mode 'insert)
 (evil-set-initial-state 'org-mode 'insert)
 #+end_src

*** enable M-. in normal mode
 #+begin_src emacs-lisp
 (define-key evil-normal-state-map (kbd "M-.")
   `(menu-item "" evil-repeat-pop :filter
               ,(lambda (cmd) (if (eq last-command 'evil-repeat-pop) cmd))))
 #+end_src

*** Cursors
 #+begin_src emacs-lisp
 (setq evil-insert-state-cursor 'bar)
 (setq evil-emacs-state-cursor 'hbar)
 #+end_src

*** Multiple cursors : evil-mc
 #+begin_src emacs-lisp
 (global-evil-mc-mode 1)

 (general-define-key
  :states 'normal
  "gz" 'bb/evil-mc)

 (hercules-def
  :toggle-funs #'bb/evil-mc
  :keymap 'evil-mc-cursors-map
  :transient t
  :flatten t)
 
 #+end_src

** Binding
 #+begin_src emacs-lisp
 (global-set-key (kbd "M-h") 'evil-window-move-far-left)
 (global-set-key (kbd "M-j") 'evil-window-move-very-bottom)
 (global-set-key (kbd "M-k") 'evil-window-move-very-top)
 (global-set-key (kbd "M-l") 'evil-window-move-far-right)

 (global-set-key (kbd "C-z") 'evil-force-normal-state)
 (global-set-key (kbd "<escape>") 'evil-force-normal-state)

 (define-key evil-normal-state-map (kbd "q") 'nil)
 (define-key evil-normal-state-map (kbd "Q") 'evil-record-macro)
 (define-key evil-insert-state-map (kbd "C-k") 'windmove-up)

 (define-key evil-insert-state-map (kbd "C-o") 'evil-jump-backward)
 (define-key evil-insert-state-map (kbd "C-i") 'evil-jump-forward)
 #+end_src

* Completion
** Company
#+begin_src emacs-lisp
(use-package company
  :config
  (global-company-mode 1)

  (setq global-company-mode t
	company-auto-complete nil
	company-minimum-prefix-length 2
	company-idle-delay 0.2))


(use-package company-quickhelp
  :init
  (defun toggle-company-quickhelp ()
    (interactive)
    (if company-quickhelp-delay
	(setq company-quickhelp-delay nil)
      (setq company-quickhelp-delay 0))
    (message company-quickhelp-delay))
  :config
  (company-quickhelp-mode)
  (setq company-quickhelp-delay nil)
  :bind (:map company-active-map
	      ("C-q" . toggle-company-quickhelp)))
#+end_src

*** NO Front-end (taken from Doom)
#+begin_src emacs-lisp :tangle no
(use-package company-box
  :hook (company-mode . company-box-mode)
  :config
  (defun +company-box-icons--elisp-fn (candidate)
    (when (derived-mode-p 'emacs-lisp-mode)
      (let ((sym (intern candidate)))
	(cond ((fboundp sym)  'ElispFunction)
	      ((boundp sym)   'ElispVariable)
	      ((featurep sym) 'ElispFeature)
	      ((facep sym)    'ElispFace)))))

  (setq company-box-show-single-candidate t
	company-box-backends-colors nil
	company-box-max-candidates 50
	company-box-icons-alist 'company-box-icons-all-the-icons
	company-box-icons-functions
	(cons #'+company-box-icons--elisp-fn
	      (delq 'company-box-icons--elisp
		    company-box-icons-functions))))
#+end_src

** Ivy
#+begin_src emacs-lisp
(when (featurep! 'ivy)
  (use-package ivy)
  (use-package ivy-hydra)
  (use-package swiper)
  (use-package counsel)
  (use-package ivy-rich)
  (use-package counsel-projectile)

  (ivy-mode 1)
  (ivy-rich-mode 1)
  (counsel-projectile-mode 1)
  (setq ivy-use-virtual-buffers t)
  (setq enable-recursive-minibuffers t)

  (setq projectile-completion-system 'ivy)
  (setq ivy-initial-inputs-alist nil)

  (use-package all-the-icons-ivy
    :init (add-hook 'after-init-hook 'all-the-icons-ivy-setup)
    :config
    (setq all-the-icons-ivy-file-commands
	  '(counsel-find-file counsel-file-jump counsel-recentf counsel-projectile-find-file counsel-projectile-find-dir))
    (setq all-the-icons-spacer " ")
    :ensure t)

  ;; (use-package ivy-posframe
  ;;   :ensure
  ;;   :after ivy
  ;;   :config
  ;;   (setq ivy-posframe-parameters
  ;; 	  '((left-fringe . 2)
  ;; 	    (right-fringe . 2)
  ;; 	    (internal-border-width . 2)
  ;; 	    ))
  ;;   (setq ivy-posframe-height-alist
  ;; 	  '((swiper . 15)
  ;; 	    (swiper-isearch . 15)
  ;; 	    (t . 10)))
  ;;   (setq ivy-posframe-display-functions-alist
  ;; 	  '((complete-symbol . ivy-posframe-display-at-point)
  ;; 	    (swiper . nil)
  ;; 	    (swiper-isearch . nil)
  ;; 	    (t . ivy-posframe-display-at-frame-center)))
  ;;   (ivy-posframe-mode 1))

  (general-define-key
   "M-x" 'counsel-M-x
   "C-x C-f" 'counsel-find-file
   "C-c o" 'swiper
   "C-c r" 'ivy-resume
   "C-c f" 'counsel-recentf
   "C-c a" 'counsel-ag)

  (define-key minibuffer-local-map (kbd "C-r") 'counsel-minibuffer-history)

  ;; ivy/counsel
  (general-define-key
   :keymaps 'ivy-minibuffer-map
   "TAB" 'ivy-call
   "C-z" 'ivy-dispatching-done
   "RET" 'ivy-alt-done)
  ;; general
  (setq projectile-completion-system 'ivy)
  (setq ivy-initial-inputs-alist nil)
  ;; bindings
  (general-define-key
   "M-x" 'counsel-M-x
   "C-x C-f" 'counsel-find-file
   "C-c o" 'swiper
   "C-c r" 'ivy-resume
   "C-c f" 'counsel-recentf
   "C-c a" 'counsel-ag)


  (define-key minibuffer-local-map (kbd "C-r") 'counsel-minibuffer-history)

  ;; ivy/counsel
  (general-define-key
   :keymaps 'ivy-minibuffer-map
   "TAB" 'ivy-call
   "C-z" 'ivy-dispatching-done
   "RET" 'ivy-alt-done))
#+end_src

** FIXME [dont work with projectile] helm
#+begin_src emacs-lisp
;; all-the-icons support
;; Must be loaded before helm (and maybe treemacs)
(when (featurep! 'helm)
  (use-package helm)
  (use-package helm-projectile)
  (use-package helm-ag)
  (use-package helm-org)
  (require 'helm-treemacs-icons)
  (helm-treemacs-icons-enable)
  ;; Basic config
  (require 'helm-config)
  (helm-mode 1)

  (customize-set-variable 'helm-ff-lynx-style-map t) ; allow going up/down dir with helm using arrow keys

  (setq helm-display-header-line t
	helm-autoresize-mode t
	helm-autoresize-min-height 20
	helm-autoresize-max-height 40
	helm-move-to-line-cycle-in-source nil
	helm-allow-mouse t
	helm-prevent-escaping-from-minibuffer nil)
  ;; Eshell enhancements
  (add-hook 'eshell-mode-hook
	    (lambda ()
	      (eshell-cmpl-initialize)
	      (define-key eshell-mode-map [remap eshell-pcomplete] 'helm-esh-pcomplete)
	      (define-key eshell-mode-map (kbd "M-p") 'helm-eshell-history)))
  ;; helm-projectile
  (require 'helm-projectile)
  (helm-projectile-on)

  ;; bindings
  (general-define-key
   "C-c o" 'helm-occur
   "C-x C-f" 'helm-find-files
   "M-x" 'helm-M-x
   "M-y" 'helm-show-kill-ring
   "C-x b" 'helm-buffers-list
   "C-x C-b" 'helm-buffers-list
   "C-c r" 'helm-resume
   "C-c f" 'helm-recentf)
  (general-define-key
   :keymaps 'helm-map
   "<tab>" 'helm-execute-persistent-action
   "C-i" 'helm-execute-persistent-action
   "C-z"  'helm-select-action)
  )
#+end_src

* Editor
** TODO treemacs
** symbol-overlay : highlight symbol at point
#+begin_src emacs-lisp
(use-package symbol-overlay
  :diminish
  :defines iedit-mode
  :commands (symbol-overlay-get-symbol
	     symbol-overlay-assoc
	     symbol-overlay-get-list
	     symbol-overlay-jump-call)
  :bind (("M-i" . symbol-overlay-put)
	 ("M-n" . symbol-overlay-jump-next)
	 ("M-p" . symbol-overlay-jump-prev)
	 ("M-N" . symbol-overlay-switch-forward)
	 ("M-P" . symbol-overlay-switch-backward)
	 ("M-C" . symbol-overlay-remove-all)
	 ([M-f3] . symbol-overlay-remove-all))
  :hook ((prog-mode . symbol-overlay-mode)
	 (iedit-mode . (lambda () (symbol-overlay-mode -1)))
	 (iedit-mode-end . symbol-overlay-mode)))
#+end_src

** flycheck : Enable nice rendering of diagnostics like compile errors
#+begin_src emacs-lisp
(use-package flycheck
  :init (global-flycheck-mode)
  :config
  (setq flycheck-check-syntax-automatically '(mode-enabled save))
  :custom
  (flycheck-display-errors-delay .3))
#+end_src

** super-save : auto save buffers when they lose focus
#+begin_src emacs-lisp
(use-package super-save
  :config
  (super-save-mode +1))
#+end_src

** Replace (M-%) : visual replace and better regexp support
#+begin_src emacs-lisp
(use-package pcre2el)
(use-package visual-regexp-steroids
  :bind ("M-%" . vr/query-replace))
(require 'visual-regexp-steroids)
#+end_src

** YAML
#+begin_src emacs-lisp
(use-package yaml-mode
  :config
  (require 'yaml-mode)
    (add-to-list 'auto-mode-alist '("\\.yml\\'" . yaml-mode)))
#+end_src

** Dockerfile
#+begin_src emacs-lisp
(use-package dockerfile-mode
  :config
  (require 'dockerfile-mode)
  (add-to-list 'auto-mode-alist '("Dockerfile\\'" . dockerfile-mode)))
#+end_src

** Multi-cursor
#+begin_src emacs-lisp

#+end_src

** Treemacs
#+begin_src emacs-lisp
(setq treemacs-is-never-other-window nil)
(general-define-key :keymaps 'treemacs-mode-map
 "O" 'treemacs-display-current-project-exclusively)
#+end_src

** Avy
#+begin_src emacs-lisp
(setq avy-all-windows t)
;;(setq avy-keys (loop for c from ?a to ?z collect c))
#+end_src

*** Bindings
#+begin_src 
(general-define-key "M-z" 'avy-goto-char-timer)
#+end_src

** Projectile
#+begin_src emacs-lisp
(setq projectile-enable-caching t)
(if (eq system-type 'windows-nt)
    (setq projectile-indexing-method 'native)
  (setq projectile-indexing-method 'hybrid))
(general-define-key "C-c p" 'projectile-command-map)
(general-define-key "C-c C-p" 'projectile-command-map)
(define-key projectile-mode-map (kbd "C-c C-p") 'projectile-command-map)
#+end_src

** which-key
 #+begin_src emacs-lisp
 (use-package which-key
   :config
   (which-key-mode +1)
   (setq which-key-sort-order #'which-key-prefix-then-key-order
	 which-key-sort-uppercase-first nil
	 which-key-add-column-padding 1
	 which-key-max-display-columns nil
	 which-key-min-display-lines 6
	 which-key-side-window-slot -10)
   (which-key-setup-minibuffer)
   (set-face-attribute 'which-key-local-map-description-face nil :weight 'bold))
 #+end_src

** multiple-cursors
#+begin_src emacs-lisp
(use-package multiple-cursors
  :config
  (require 'multiple-cursors))
#+end_src

*** Bindings
#+begin_src emacs-lisp
;; mc/num-cursors is not autoloaded
(require 'multiple-cursors)

(defhydra hydra-multiple-cursors (:hint nil)
  "
 Up^^             Down^^           Miscellaneous           % 2(mc/num-cursors) cursor%s(if (> (mc/num-cursors) 1) \"s\" \"\")
------------------------------------------------------------------
 [_p_]   Next     [_n_]   Next     [_l_] Edit lines  [_0_] Insert numbers
 [_P_]   Skip     [_N_]   Skip     [_a_] Mark all    [_A_] Insert letters
 [_M-p_] Unmark   [_M-n_] Unmark   [_s_] Search
 [Click] Cursor at point       [_q_] Quit"
  ("l" mc/edit-lines :exit t)
  ("a" mc/mark-all-like-this :exit t)
  ("n" mc/mark-next-like-this)
  ("N" mc/skip-to-next-like-this)
  ("M-n" mc/unmark-next-like-this)
  ("p" mc/mark-previous-like-this)
  ("P" mc/skip-to-previous-like-this)
  ("M-p" mc/unmark-previous-like-this)
  ("s" mc/mark-all-in-region-regexp :exit t)
  ("0" mc/insert-numbers :exit t)
  ("A" mc/insert-letters :exit t)
  ("<mouse-1>" mc/add-cursor-on-click)
  ;; Help with click recognition in this hydra
  ("<down-mouse-1>" ignore)
  ("<drag-mouse-1>" ignore)
  ("q" nil))
#+end_src

** extand-region
#+begin_src emacs-lisp
(use-package expand-region
  :config
  (require 'expand-region)
  :bind ("C-=" . er/expand-region))
#+end_src

** Smartparens
*** Packages
  #+begin_src emacs-lisp
  (use-package smartparens)
  #+end_src

*** Configuration
  #+begin_src emacs-lisp
  (require 'smartparens-config)
  (smartparens-global-mode nil)
  #+end_src

*** Bindings
**** Hydra
  #+begin_src emacs-lisp
  (defhydra hydra-smartparens (:hint nil)
    "
   Moving^^^^                       Slurp & Barf^^   Wrapping^^            Sexp juggling^^^^               Destructive
  ------------------------------------------------------------------------------------------------------------------------
   [_a_] beginning  [_n_] down      [_h_] bw slurp   [_R_]   rewrap        [_S_] split   [_t_] transpose   [_c_] change inner  [_w_] copy
   [_e_] end        [_N_] bw down   [_H_] bw barf    [_u_]   unwrap        [_s_] splice  [_A_] absorb      [_C_] change outer
   [_f_] forward    [_p_] up        [_l_] slurp      [_U_]   bw unwrap     [_r_] raise   [_E_] emit        [_k_] kill          [_g_] quit
   [_b_] backward   [_P_] bw up     [_L_] barf       [_(__{__[_] wrap (){}[]   [_j_] join    [_o_] convolute   [_K_] bw kill       [_q_] quit"
    ;; Moving
    ("a" sp-beginning-of-sexp)
    ("e" sp-end-of-sexp)
    ("f" sp-forward-sexp)
    ("b" sp-backward-sexp)
    ("n" sp-down-sexp)
    ("N" sp-backward-down-sexp)
    ("p" sp-up-sexp)
    ("P" sp-backward-up-sexp)

    ;; Slurping & barfing
    ("h" sp-backward-slurp-sexp)
    ("H" sp-backward-barf-sexp)
    ("l" sp-forward-slurp-sexp)
    ("L" sp-forward-barf-sexp)

    ;; Wrapping
    ("R" sp-rewrap-sexp)
    ("u" sp-unwrap-sexp)
    ("U" sp-backward-unwrap-sexp)
    ("(" sp-wrap-round)
    ("{" sp-wrap-curly)
    ("[" sp-wrap-square)

    ;; Sexp juggling
    ("S" sp-split-sexp)
    ("s" sp-splice-sexp)
    ("r" sp-raise-sexp)
    ("j" sp-join-sexp)
    ("t" sp-transpose-sexp)
    ("A" sp-absorb-sexp)
    ("E" sp-emit-sexp)
    ("o" sp-convolute-sexp)

    ;; Destructive editing
    ("c" sp-change-inner :exit t)
    ("C" sp-change-enclosing :exit t)
    ("k" sp-kill-sexp)
    ("K" sp-backward-kill-sexp)
    ("w" sp-copy-sexp)

    ("q" nil)
    ("g" nil))

  (general-define-key
   "S-SPC" 'hydra-smartparens/body)
  #+end_src

** org-mode
*** Packages
 #+begin_src emacs-lisp
 (use-package org-bullets)
 (use-package grip-mode)
 (use-package ox-gfm
   :config
   (eval-after-load "org"
   '(require 'ox-gfm nil t)))
 #+end_src

*** Configuration
**** General
 #+begin_src emacs-lisp
 (setq org-directory (expand-file-name "org-files" user-emacs-directory))
 (setq org-log-done 'time)

 (add-to-list 'auto-mode-alist '("\\.org\\’" . org-mode))
 (add-to-list 'auto-mode-alist '("\\.txt\\'" . org-mode))
 (add-to-list 'auto-mode-alist '("\\.rst\\'" . org-mode))
 (add-to-list 'auto-mode-alist '("\\.md\\'" . org-mode))

 (setq org-edit-src-content-indentation 0)
 (setq org-confirm-babel-evaluate nil)
 #+end_src

 #+RESULTS:

**** Org bullets
 #+begin_src emacs-lisp
 (require 'org-bullets)
 (setq org-bullets-bullet-list
       '("◉" "○"))
 (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1)))
 #+end_src

**** TODO Agenda
 #+begin_src emacs-lisp
 (setq org-agenda-files (directory-files-recursively "~/org-files/" "\.org$"))
 (setq org-capture-dir (expand-file-name "org-files" user-emacs-directory))

 ;; TODO don't use hard written folder for captures
 (setq org-capture-templates
       '(("t" "Todo (ADYL)" entry (file+headline "~/.emacs.d/org-files/agenda-adyl.org" "TODOS")
	  "* TODO %?\n  %U\n")
	 ("a" "Agenda (ADYL)" entry (file+datetree "~/.emacs.d/org-files/agenda-adyl.org" "Agenda")
	  "* %?\nEntered on %U\n")
	 ("n" "Note" entry (file+datetree "~/.emacs.d/org-files/notes.org" "Notes")
	  "* %?\nEntered on %U\n")))
 (setq org-agenda-skip-scheduled-if-done t
       org-agenda-skip-deadline-if-done t
       org-agenda-include-deadlines t
       org-agenda-block-separator nil
       org-agenda-compact-blocks t
       org-agenda-start-day nil ;; i.e. today
       org-agenda-span 1
       org-agenda-start-on-weekday nil)
 (setq org-agenda-custom-commands
       '(("c" "Super view"
	  ((agenda "" ((org-agenda-overriding-header "")
		       (org-super-agenda-groups
			'((:name "Today"
				 :time-grid t
				 :date today
				 :order 1)))))
	   (alltodo "" ((org-agenda-overriding-header "")
			(org-super-agenda-groups
			 '((:log t)
			   (:name "To refile"
				  :file-path "refile\\.org")
			   (:name "Next to do"
				  :todo "NEXT"
				  :order 1)
			   (:name "Important"
				  :priority "A"
				  :order 6)
			   (:name "Today's tasks"
				  :file-path "journal/")
			   (:name "Due Today"
				  :deadline today
				  :order 2)
			   (:name "Scheduled Soon"
				  :scheduled future
				  :order 8)
			   (:name "Overdue"
				  :deadline past
				  :order 7)
			   (:name "Meetings"
				  :and (:todo "MEET" :scheduled future)
				  :order 10)
			   (:discard (:not (:todo "TODO")))))))))))
 #+end_src

**** Lisp
 #+begin_src emacs-lisp
 (defun bb-org-evaluate-and-next ()
   (interactive)
   (call-interactively 'org-ctrl-c-ctrl-c)
   (org-babel-next-src-block))
 #+end_src
*** Export resume with org mode
#+begin_src emacs-lisp
(use-package ox-moderncv
    :load-path "~/.emacs.d/lisp/org-cv"
    :init (require 'ox-moderncv))
(defun bb/export-resume ()
  (interactive)
  (let ((texfile (concat (file-name-sans-extension (buffer-name)) ".tex")))
    (org-export-to-file 'moderncv texfile)
    (org-latex-compile texfile)))
  
#+end_src
*** Bindings
 #+begin_src emacs-lisp
 (mode-leader org-mode-map
   "c" 'bb/export-cv-current-file
   "f" 'org-gfm-convert-region-to-md
   "F" 'grip-mode
   "h" 'org-insert-heading
   "i" 'org-insert-item
   "!" 'bb-org-evaluate-and-next
   )

 (when (featurep! 'helm)
   (mode-leader org-mode-map
     "g" 'helm-org-in-buffer-headings
     "G" 'helm-org-rifle))

 (when (featurep! 'ivy)
   (mode-leader org-mode-map
     "g" 'counsel-org-goto))
 #+end_src

** Crux
#+begin_src emacs-lisp
(use-package crux)
#+end_src

*** Bindings
#+begin_src emacs-lisp
(general-define-key
 "s-k" 'crux-kill-whole-line
 "C-c n" 'crux-cleanup-buffer-or-region
 "M-o" 'crux-smart-open-line
 "M-O" 'crux-smart-open-line-above
 "C-c d" 'crux-duplicate-current-line-or-region
 "C-x C-u" 'crux-upcase-region
 "C-x C-l" 'crux-downcase-region)
#+end_src

** Magit
#+begin_src emacs-lisp
(use-package magit)
#+end_src
* Lang
** Lsp
*** Packages
**** lsp-mode
#+begin_src emacs-lisp
(use-package lsp-mode
  :requires hydra helm helm-lsp
  :hook
  (lsp-mode . lsp-lens-mode)
  :config (setq lsp-prefer-flymake nil))

;; lsp-mode supports snippets, but in order for them to work you need to use yasnippet
;; If you don't want to use snippets set lsp-enable-snippet to nil in your lsp-mode settings
;;   to avoid odd behavior with snippets and indentation
(use-package yasnippet)

(use-package company-lsp
  :config
  (require 'company-lsp)
  (push 'company-lsp company-backends))
#+end_src

**** lsp-ui
#+begin_src emacs-lisp
(use-package lsp-ui
  :hook (lsp-mode . lsp-ui-mode)
  :config
  (lsp-ui-imenu-enable t)
  (lsp-ui-peek-enable t)
  (setq lsp-ui-doc-mode t
        lsp-ui-doc-position 'bottom
        lsp-ui-doc-alignment 'window
        lsp-ui-doc-include-signature t
        lsp-ui-sideline-mode nil
        lsp-ui-sideline-show-hover t
        lsp-ui-sideline-show-diagnostics t
        lsp-ui-sideline-ignore-duplicate t
        lsp-ui-sideline-show-symbol t
        lsp-ui-sideline-show-code-actions t
        lsp-ui-sideline-show-code-actions t
        lsp-ui-imenu-enable t
        lsp-ui-imenu-colors `(,(face-foreground 'font-lock-keyword-face)
                              ,(face-foreground 'font-lock-string-face)
                              ,(face-foreground 'font-lock-constant-face)
                              ,(face-foreground 'font-lock-variable-name-face)))
  (define-key lsp-ui-mode-map [remap xref-find-definitions] #'lsp-ui-peek-find-definitions)
  (define-key lsp-ui-mode-map [remap xref-find-references] #'lsp-ui-peek-find-references)
  (define-key lsp-ui-mode-map (kbd "C-q") 'lsp-ui-doc-glance)
  (define-key lsp-ui-mode-map (kbd "<C-mouse-1>") 'lsp-find-references))

(use-package helm-lsp
  :config
  (define-key lsp-ui-mode-map (kbd "M-n") 'helm-lsp-workspace-symbol))
#+end_src

**** Debug : dap-mode
#+begin_src emacs-lisp
(use-package posframe
  ;; Posframe is a pop-up tool that must be manually installed for dap-mode
  :ensure t)

(use-package dap-mode
  :functions dap-hydra/nil
  :diminish
  :config
  ;; enables mouse hover support
  (dap-tooltip-mode 1)
  ;; use tooltips for mouse hover
  ;; if it is not enabled `dap-mode' will use the minibuffer.
  (tooltip-mode 1)
  :bind (:map lsp-mode-map
              ("<f5>" . dap-debug)
              ("M-<f5>" . dap-hydra))
  :hook ((after-init . dap-mode)
         (dap-mode . dap-ui-mode)
         (dap-session-created . (lambda (_args) (dap-hydra)))
         (dap-stopped . (lambda (_args) (dap-hydra)))
         (dap-terminated . (lambda (_args) (dap-hydra/nil)))

         (python-mode . (lambda () (require 'dap-python)))
         (ruby-mode . (lambda () (require 'dap-ruby)))
         (go-mode . (lambda () (require 'dap-go)))
         (java-mode . (lambda () (require 'dap-java)))
         ((c-mode c++-mode objc-mode swift-mode) . (lambda () (require 'dap-lldb)))
         (php-mode . (lambda () (require 'dap-php)))
         (elixir-mode . (lambda () (require 'dap-elixir)))
         ((js-mode js2-mode) . (lambda () (require 'dap-chrome)))
         (powershell-mode . (lambda () (require 'dap-pwsh)))))
#+end_src

*** Enables lsp in those languages
**** Python
  #+begin_src emacs-lisp
  ;; lsp python
  (add-hook 'python-mode-hook #'lsp-deferred)
  (require 'dap-python)
  #+end_src

*** Bindings
**** hydra
  #+begin_src emacs-lisp
  (defhydra hydra-lsp (:exit t :hint nil)
    "
   Buffer^^               Server^^                   Symbol
  -------------------------------------------------------------------------------------
   [_f_] format           [_M-r_] restart            [_d_] declaration  [_i_] implementation  [_o_] documentation
   [_m_] imenu            [_S_]   shutdown           [_D_] definition   [_t_] type            [_r_] rename
   [_x_] execute action   [_M-s_] describe session   [_R_] references   [_s_] signature
   [_l_] flycheck-list
  "
    ("d" lsp-find-declaration)
    ("D" lsp-ui-peek-find-definitions)
    ("R" lsp-ui-peek-find-references)
    ("i" lsp-ui-peek-find-implementation)
    ("t" lsp-find-type-definition)
    ("s" lsp-signature-help)
    ("o" lsp-describe-thing-at-point)
    ("r" lsp-rename)
    ("l" lsp-ui-flycheck-list)

    ("f" lsp-format-buffer)
    ("m" lsp-ui-imenu)
    ("x" lsp-execute-code-action)

    ("M-s" lsp-describe-session)
    ("M-r" lsp-restart-workspace)
    ("S" lsp-shutdown-workspace))

  ;; (general-define-key
  ;;  :keymaps lsp-mode-map
  ;;  "<f9>" 'hydra-lsp/body)
  #+end_src

** Python
   #+begin_src emacs-lisp
(use-package pyvenv)
(use-package elpy
  :config
  (elpy-enable)
  (setq elpy-rpc-backend "jedi")
  (defalias 'workon 'pyvenv-workon)
  (remove-hook 'elpy-modules 'elpy-module-flymake)
  (add-hook 'elpy-mode-hook (lambda () (highlight-indentation-mode -1)))
  (setenv "WORKON_HOME" "~/.virtualenvs")
  (setq python-shell-interpreter "ipython"
	python-shell-interpreter-args "-i --simple-prompt")
  (add-to-list 'python-shell-completion-native-disabled-interpreters
	       "jupyter")
  (add-hook 'elpy-mode-hook (lambda () (highlight-indentation-mode -1))))
#+end_src
*** Poetry
#+begin_src emacs-lisp
(use-package poetry
 :ensure t)
#+end_src
*** Bindings
#+begin_src emacs-lisp
(mode-leader python-mode-map
  "c" 'poetry-tracking-mode
  "p" 'poetry
)
#+end_src
** Clojure
*** Packages
  #+begin_src emacs-lisp
  (use-package cider)
  (use-package cider-hydra
    :config
    (add-hook 'clojure-mode-hook #'cider-hydra-mode))
  #+end_src

*** Bindings
  #+begin_src emacs-lisp
  (mode-leader cider-mode-map
   "ù" 'cider-test-rerun-test
   "d" 'cider-hydra-doc/body
   "e" 'cider-hydra-eval/body
   "r" 'cider-hydra-repl/body
   "u" 'cider-hydra-test/body
   "T" 'cider-test-rerun-failed-tests
   "t" 'cider-test-run-test)
  (general-define-key
   :states 'normal
   :keymaps 'cider-mode-map
   "!" 'cider-eval-last-sexp
   "§" 'cider-eval-last-sexp-in-context)
  (general-define-key
   :states '(insert emacs)
   :keymaps 'cider-mode-map
   "C-:" 'company-complete)
  #+end_src

* Term
** Eshell
*** Configuration
#+begin_src emacs-lisp
(setq eshell-banner-message
      '(format "%s %s\n"
	       (propertize (format " %s " (string-trim (buffer-name)))
			   'face 'mode-line-highlight)
	       (propertize (current-time-string)
			   'face 'font-lock-keyword-face))
      eshell-scroll-to-bottom-on-input 'all
      eshell-scroll-to-bottom-on-output 'all
      eshell-buffer-shorthand t
      eshell-kill-processes-on-exit t
      eshell-hist-ignoredups t
      ;; don't record command in history if prefixed with whitespace
      ;; TODO Use `eshell-input-filter-initial-space' when Emacs 25 support is dropped
      eshell-input-filter (lambda (input) (not (string-match-p "\\`\\s-+" input)))
      ;; em-prompt
      eshell-prompt-regexp "^.* λ "
      eshell-prompt-function #'+eshell-default-prompt-fn
      ;; em-glob
      eshell-glob-case-insensitive t
      eshell-error-if-no-glob t)

(add-hook 'eshell-mode-hook
  (defun +eshell-remove-fringes-h ()
    (set-window-fringes nil 0 0)
    (set-window-margins nil 1 nil)))

(add-hook 'eshell-mode-hook
  (defun +eshell-enable-text-wrapping-h ()
    (visual-line-mode +1)
    (set-display-table-slot standard-display-table 0 ?\ )))

(add-hook 'eshell-mode-hook #'hide-mode-line-mode)
#+end_src

*** Packages
#+begin_src emacs-lisp
(use-package virtualenvwrapper)

(use-package eshell-toggle)
(use-package hide-mode-line)

(use-package eshell-prompt-extras
  :config
  (with-eval-after-load "esh-opt"
    (autoload 'epe-theme-lambda "eshell-prompt-extras")
    (setq eshell-highlight-prompt nil
	  eshell-prompt-function 'epe-theme-lambda))
  (with-eval-after-load "esh-opt"
    (require 'virtualenvwrapper)
    (venv-initialize-eshell)
    (autoload 'epe-theme-lambda "eshell-prompt-extras")
    (setq eshell-highlight-prompt nil
	  eshell-prompt-function 'epe-theme-lambda)))

(use-package eshell-z
  :config
  (add-hook 'eshell-mode-hook
	    (defun my-eshell-mode-hook ()
	      (require 'eshell-z)))
  (unless (file-exists-p eshell-z-freq-dir-hash-table-file-name)
    (setq eshell-z-freq-dir-hash-table-file-name
	  (expand-file-name "z" eshell-directory-name))))
#+end_src

*** Lisp
src:doom-emacs
#+begin_src emacs-lisp
(defun doom-call-process (command &rest args)
  "Execute COMMAND with ARGS synchronously.

Returns (STATUS . OUTPUT) when it is done, where STATUS is the returned error
code of the process and OUTPUT is its stdout output."
  (with-temp-buffer
    (cons (or (apply #'call-process command nil t nil args)
	      -1)
	  (string-trim (buffer-string)))))


(defface +eshell-prompt-pwd '((t (:inherit font-lock-constant-face)))
  "TODO"
  :group 'eshell)

(defface +eshell-prompt-git-branch '((t (:inherit font-lock-builtin-face)))
  "TODO"
  :group 'eshell)

(defun +eshell--current-git-branch ()
  ;; TODO Refactor me
  (cl-destructuring-bind (status . output)
      (doom-call-process "git" "symbolic-ref" "-q" "--short" "HEAD")
    (if (equal status 0)
	(format " [%s]" output)
      (cl-destructuring-bind (status . output)
	  (doom-call-process "git" "describe" "--all" "--always" "HEAD")
	(if (equal status 0)
	    (format " [%s]" output)
	  "")))))

(defun +eshell-default-prompt-fn ()
  "Generate the prompt string for eshell. Use for `eshell-prompt-function'."
  (require 'shrink-path)
  (concat "\n -> "
	  (let ((pwd (eshell/pwd)))
	    (propertize pwd
			'face '+eshell-prompt-pwd))
	  (propertize (+eshell--current-git-branch)
		      'face '+eshell-prompt-git-branch)
	  "\n"
	  (propertize " λ" 'face (if (zerop eshell-last-command-status) 'success 'error))
	  " "))

(defun bb-eshell-projectile-here ()
  (interactive)
  (let ((project (projectile-project-root)))
    (if project
	(projectile-with-default-dir project (eshell-toggle))
      (eshell-toggle))))
#+end_src

** Vterm
Requires some stuff to be put in .bashrc ([[https://github.com/akermu/emacs-libvterm][see here]])
#+begin_src emacs-lisp
(use-package vterm
  :config
  (setq vterm-kill-buffer-on-exit t)

  (general-define-key
   :keymaps 'vterm-mode-map
   "<f9>" 'vterm-copy-mode)

  (general-define-key
   :keymaps 'vterm-copy-mode-map
   "<f9>" 'vterm-copy-mode-done)

  (use-package vterm-toggle
    :config
    (setq vterm-toggle-fullscreen-p nil)
    (add-to-list 'display-buffer-alist
		 '((lambda(bufname _) (with-current-buffer bufname (equal major-mode 'vterm-mode)))
		   (display-buffer-reuse-window display-buffer-at-bottom)
		   ;;(display-buffer-reuse-window display-buffer-in-direction)
		   ;;display-buffer-in-direction/direction/dedicated is added in emacs27
		   ;;(direction . bottom)
		   ;;(dedicated . t) ;dedicated is supported in emacs27
		   (reusable-frames . visible)
		   (window-height . 0.3))))
  
  (general-define-key
   "C-M-!" 'vterm-toggle)
  )
#+end_src
* Appearance
** General
#+begin_src emacs-lisp
(blink-cursor-mode 0)
(setq-default cursor-type 'bar)
(auto-composition-mode 0)
#+end_src

** Dashboard
 #+begin_src emacs-lisp
(setq recentf-exclude (org-agenda-files))
(use-package dashboard
   :ensure t
   :config
   (dashboard-setup-startup-hook)

   (setq dashboard-center-content t)
   (setq initial-buffer-choice (lambda () (get-buffer "*dashboard*")))
   (setq show-week-agenda-p t)
   (setq dashboard-items '((recents  . 10)
		    (projects . 10)
		    (agenda . 5)))
   (setq dashboard-set-heading-icons t)
   (setq dashboard-set-file-icons t)
   (setq dashboard-set-navigator t)
   (setq dashboard-set-footer nil)

   ;; fixes a bug where dashboard lines takes two lines
   (set-fontset-font "fontset-default"
	    (cons page-break-lines-char page-break-lines-char)
	    (face-attribute 'default :family)))
#+end_src

** FIXME centaur-tabs
It makes emacs very laggy
 #+begin_src emacs-lisp :tangle no
(use-package centaur-tabs
   :demand
   :config
   (centaur-tabs-mode t)
   (setq centaur-tabs-set-icons t)
   (setq centaur-tabs-cycle-scope 'tabs)
   (centaur-tabs-group-by-projectile-project)
   (setq centaur-tabs-adjust-buffer-order t)
   :bind
   ("C-²" . centaur-tabs-forward)
   ("C-~" . centaur-tabs-backward))
 #+end_src

** Theme
#+BEGIN_SRC emacs-lisp
;; (add-to-list 'custom-theme-load-path "~/.emacs.d/themes/")
;; (load-theme 'leuven t)
;; (set-face-attribute 'centaur-tabs-selected nil :foreground "#000000" :background "#cceeff")
;; (set-face-attribute 'centaur-tabs-selected-modified nil :foreground "#880000" :background "#cceeff")
;; (set-face-attribute 'centaur-tabs-unselected nil :foreground "#808075" :background "#eaffff")
;; (set-face-attribute 'centaur-tabs-unselected-modified nil :foreground "#880000" :background "#eaffff")
(use-package parchment-theme)
(load-theme 'doom-dracula t)
#+END_SRC

** all-the-icons
#+BEGIN_SRC emacs-lisp
(use-package all-the-icons)
(use-package all-the-icons-dired
  :config
  (add-hook 'dired-mode-hook 'all-the-icons-dired-mode))
#+END_SRC

** rainbow-delimiters
#+begin_src emacs-lisp
(use-package rainbow-delimiters
  :config
  (require 'rainbow-delimiters)
  (add-hook 'prog-mode-hook 'rainbow-delimiters-mode)
  :ensure t)
#+end_src

** Modeline
#+BEGIN_SRC emacs-lisp
(setq bb/modeline 'doom) ;; either 'doom or 'feebleline
(cond ((eq bb/modeline 'feebleline)
       (use-package feebleline
	 :config       (setq feebleline-msg-functions
			     '((feebleline-line-number         :post "" :fmt "%5s")
			       (feebleline-column-number       :pre ":" :fmt "%-2s")
			       (feebleline-file-directory      :face feebleline-dir-face :post "")
			       (feebleline-file-or-buffer-name :face font-lock-keyword-face :post "")
			       (feebleline-file-modified-star  :face font-lock-warning-face :post "")
			       (feebleline-git-branch          :face feebleline-git-face :pre " : ")
			       (feebleline-project-name        :align right)))
	 (feebleline-mode 1)))
      ((eq bb/modeline 'doom)
       (use-package ghub)
       (use-package doom-modeline
	 :init (doom-modeline-mode 1)
	 :config
	 (setq doom-modeline-icon (display-graphic-p))
	 (setq doom-modeline-major-mode-color-icon t)
	 (setq doom-modeline-buffer-state-icon t)
	 (setq doom-modeline-buffer-modification-icon t)
	 (setq doom-modeline-github t))))
#+END_SRC

** Font
#+BEGIN_SRC emacs-lisp
(set-face-attribute 'default nil
		    :family "ibm plex mono"
		    :foundry "ibm"
		    :slant 'normal
		    :weight 'normal :height 90
		    :width 'normal)
#+END_SRC

* Lisp
** Open the folder with thunar
#+begin_src emacs-lisp
(defun browse-file-directory ()
  "Open the current file's directory however the OS would."
  (interactive)
  (shell-command "thunar")
)
#+end_src

* Bindings
** General
#+BEGIN_SRC emacs-lisp
(general-auto-unbind-keys)
(require 'bb-func)

(global-set-key [mouse-3] 'mouse-popup-menubar-stuff)
(global-set-key (kbd "C-<mouse-5>") 'text-scale-decrease)
(global-set-key (kbd "C-<mouse-4>") 'text-scale-increase)
(global-set-key [C-down-mouse-3] 'yank)
(global-set-key (kbd "C-²") 'other-frame)
(global-set-key (kbd "C-h") 'windmove-left)
(global-set-key (kbd "C-j") 'windmove-down)
(global-set-key (kbd "C-l") 'windmove-right)
(global-set-key (kbd "C-:") 'company-complete)
(global-set-key (kbd "M-*") 'avy-goto-char-timer)
(global-set-key (kbd "M-,") 'kill-buffer-and-window)
(global-set-key (kbd "C-!") 'bb-eshell-projectile-here)
(global-set-key (kbd "C-M-<left>") 'winner-undo)
(global-set-key (kbd "C-M-<right>") 'winner-redo)
#+END_SRC

** Evil
#+BEGIN_SRC emacs-lisp
(global-set-key (kbd "M-h") 'bb/evil-window-move-far-left)
(global-set-key (kbd "M-j") 'bb/evil-window-move-very-bottom)
(global-set-key (kbd "M-k") 'bb/evil-window-move-very-top)
(global-set-key (kbd "M-l") 'bb/evil-window-move-far-right)
#+END_SRC

*** Lisp
#+begin_src emacs-lisp
(defmacro evil-save-side-windows (&rest body)
  "Toggle side windows, evaluate BODY, restore side windows."
  (declare (indent defun) (debug (&rest form)))
  (let ((sides (make-symbol "sidesvar")))
    `(let ((,sides (and (functionp 'window-toggle-side-windows)
			(window-with-parameter 'window-side))))
       (when ,sides
	 (window-toggle-side-windows))
       (unwind-protect
	   (progn ,@body)
	 (when ,sides
	   (window-toggle-side-windows))))))

(defun evil-move-window (side)
  "Move the `selected-window' to SIDE.
The state of the `selected-window' is saved along with the state
of the window tree consisting of all the other windows. Then, all
windows are deleted, the remaining window is split according to
SIDE, the state of the window at SIDE is replaced with the saved
state of the `selected-window', and, finally, the state of the
saved window tree is reconstructed on the opposite side.

SIDE has the same meaning as in `split-window'.

Note, this function only operates on the window tree rooted in
the frame's main window and effectively preserves any side
windows \(i.e. windows with a valid window-side window
parameter\)."
  (evil-save-side-windows
    (unless (one-window-p)
      (save-excursion
	(let ((w (window-state-get (selected-window))))
	  (delete-window)
	  (let ((wtree (window-state-get)))
	    (delete-other-windows)
	    (let ((subwin (selected-window))
		  ;; NOTE: SIDE is new in Emacs 24
		  (newwin (split-window nil nil side)))
	      (window-state-put wtree subwin)
	      (window-state-put w newwin)
	      (select-window newwin)))))
      (balance-windows))))

(defun bb/evil-window-move-very-top ()
  (interactive)
  (evil-move-window 'above))

(defun bb/evil-window-move-far-left ()
  (interactive)
  (evil-move-window 'left))

(defun bb/evil-window-move-far-right ()
  (interactive)
  (evil-move-window 'right))

(defun bb/evil-window-move-very-bottom ()
  (interactive)
  (evil-move-window 'below))
#+end_src

** Windmove
Use shift + arrow keys to switch between visible buffers
#+BEGIN_SRC emacs-lisp
(require 'windmove)
(windmove-default-keybindings)
#+END_SRC

** Leader
#+BEGIN_SRC emacs-lisp
(use-package terminal-here)

(-each '("²" "<f12>")
  (lambda (key)
    (general-define-key
  ;; :prefix my-leader
  :prefix key
 "e" '(:ignore t :which-key "Edits")
 "ee" 'helm-show-kill-ring
 "eu" 'undo-tree-visualize
 "f" '(:ignore t :which-key "Files")
 "fd" 'dired-jump
 "fD" 'ranger
 "ff" 'helm-find-files
 "fg" 'browse-file-directory
 "fl" 'helm-locate
 "fn" 'deft
 "fN" 'deft-new-file
 "fo" 'bb-org-rifle
 "fO" 'helm-org-rifle-org-directory
 "fr" 'helm-recentf
 "ft" 'treemacs-add-and-display-current-project
 "m" 'hydra-multiple-cursors/body
 "o" '(:ignore t :which-key "Search (occur/ag)")
 "oa" 'helm-do-grep-ag
 "oA" 'helm-do-ag
 "om" 'helm-multi-swoop-all
 "oM" 'helm-multi-swoop
 "oo" 'helm-occur
 "oO" 'helm-swoop
 "p" 'projectile-command-map
 "t" '(:ignore t :which-key "Tools")
 "td" 'docker
 "tk" 'kubernetes-overview
 "tm" 'magit-status
 "tt" 'terminal-here
 "t+" 'calc
 "w" '(:ignore t :which-key "Window")
 "wm" 'menu-bar-mode
 "wc" 'bb/tear-off-window
 "ww" 'toggle-truncate-lines
 ;; others
 "a" 'org-capture
 "A" 'org-agenda
 "b" 'helm-mini
 "p" 'projectile-command-map
 "RET" 'helm-resume
 "!" 'helm-company
 "M-x" 'helm-M-x ; useful in cases of bugs
 "<right>" 'bb/evil-window-move-far-right
 "<left>" 'bb/evil-window-move-far-left
 "<up>" 'bb/evil-window-move-very-top
 "<down>" 'bb/evil-window-move-very-bottom
 )))


#+END_SRC

